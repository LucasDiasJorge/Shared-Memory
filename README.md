# Shared-Memory

This project demonstrates how to use shared memory in C, specifically leveraging the `sys/shm.h` library for inter-process communication (IPC). The examples include writing and reading a `struct` to and from shared memory.

## Overview

Shared memory is one of the fastest methods for IPC, allowing multiple processes to access the same memory space. This project provides example codes to help you understand how to create, use, and manage shared memory segments in C.

### Resources

- **Video Tutorial**: [Introduction to Shared Memory in C](https://www.youtube.com/watch?v=WgVSq-sgHOc) - A comprehensive guide to understanding shared memory concepts and implementation.
  
- **Documentation**: [POSIX `sys/shm.h`](https://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/shm.h.html) - Official documentation for the shared memory functions and macros defined in `sys/shm.h`.

## Key Functions in `sys/shm.h`

Below are the key functions provided by the `sys/shm.h` library used in the examples:

### 1. `ftok()`

- **Purpose**: Generates a unique key for shared memory segment identification.
- **Usage**: 
  ```c
  key_t key = ftok(const char *pathname, int proj_id);
  ```
- **Parameters**:
  - `pathname`: Path to an existing file (typically in `/tmp`).
  - `proj_id`: Project identifier to differentiate between keys.

### 2. `shmget()`

- **Purpose**: Allocates a shared memory segment or accesses an existing one.
- **Usage**:
  ```c
  int shmid = shmget(key_t key, size_t size, int shmflg);
  ```
- **Parameters**:
  - `key`: Key generated by `ftok()`.
  - `size`: Size of the shared memory segment.
  - `shmflg`: Flags for memory segment permissions and creation (`IPC_CREAT` to create if it doesn’t exist).

### 3. `shmat()`

- **Purpose**: Attaches the shared memory segment to the process’s address space.
- **Usage**:
  ```c
  void *shmaddr = shmat(int shmid, const void *shmaddr, int shmflg);
  ```
- **Parameters**:
  - `shmid`: Shared memory ID returned by `shmget()`.
  - `shmaddr`: Address where to attach (usually `NULL` for automatic placement).
  - `shmflg`: Flags for attachment options.

### 4. `shmdt()`

- **Purpose**: Detaches the shared memory segment from the process’s address space.
- **Usage**:
  ```c
  int status = shmdt(const void *shmaddr);
  ```
- **Parameters**:
  - `shmaddr`: Address of the shared memory segment to detach.

### 5. `shmctl()`

- **Purpose**: Performs various control operations on the shared memory segment.
- **Usage**:
  ```c
  int status = shmctl(int shmid, int cmd, struct shmid_ds *buf);
  ```
- **Parameters**:
  - `shmid`: Shared memory ID.
  - `cmd`: Command to perform (`IPC_RMID` to remove the segment).
  - `buf`: Buffer for metadata (usually `NULL` for removal).

### Compile

```bash
gcc -o write_struct write_struct.c
gcc -o read_struct read_struct.c
```

### Run

1. **Write to Shared Memory**:
   ```bash
   ./write_struct
   ```
2. **Read from Shared Memory**:
   ```bash
   ./read_struct
   ```

## Conclusion

This project demonstrates the use of shared memory in C for efficient IPC. By following the example codes, you can implement shared memory in your own applications, making data exchange between processes both fast and efficient.